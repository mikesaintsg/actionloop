<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>@mikesaintsg/actionloop Showcase</title>
  <script type="module" crossorigin>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();class u extends Error{code;nodeId;transitionKey;sessionId;cause;constructor(t,e,s){super(e),this.name="ActionLoopError",this.code=t,s?.nodeId!==void 0&&(this.nodeId=s.nodeId),s?.transitionKey!==void 0&&(this.transitionKey=s.transitionKey),s?.sessionId!==void 0&&(this.sessionId=s.sessionId),s?.cause!==void 0&&(this.cause=s.cause),Error.captureStackTrace&&Error.captureStackTrace(this,u)}}const _=18e5,D=.9,P=.001,R=864e5,W=5,F=50,H=10,V=2,z=5,q=10,B=5e3,j=5,$=1;function E(){const c=Date.now().toString(36),t=Math.random().toString(36).substring(2,10);return`${c}-${t}`}function w(c,t){return`${c}->${t}`}function S(c,t,e){return`${c}::${t}::${e}`}function v(c){if(c===null||typeof c!="object")return c;Object.freeze(c);for(const t of Object.keys(c)){const e=c[t];e!==null&&typeof e=="object"&&!Object.isFrozen(e)&&v(e)}return c}function m(){return Date.now()}function G(c){let t=0,e=!1,s="";for(const o of c)if(e)o===s&&(e=!1);else if(o==='"'||o==="'")e=!0,s=o;else if(o==="(")t++;else if(o===")"&&(t--,t<0))return!1;return t===0&&!e}function O(c){return c.startsWith('"')&&c.endsWith('"')||c.startsWith("'")&&c.endsWith("'")?c.slice(1,-1):/^-?\d+(\.\d+)?$/.test(c)?parseFloat(c):c==="true"?!0:c==="false"?!1:c}class K{#t;#e;#s;#n;#o;#i;constructor(t){if(this.#t=new Map,this.#e=new Map,this.#s=new Map,this.#n=new Map,this.#o=new Map,this.#i=new Set,t.onValidation&&this.#i.add(t.onValidation),t.nodes)for(const e of t.nodes)this.#a(e);for(const e of t.transitions)this.#c(e);if(t.procedures)for(const e of t.procedures)this.#r(e);if(t.validateOnCreate!==!1){const s=this.validate().filter(n=>n.severity==="error"),o=s[0];if(o)throw new u("BUILD_FAILED",`Procedural graph validation failed with ${s.length} error(s): ${o.message}`)}}#a(t){const e=v(Object.assign({id:t.id},t.label!==void 0?{label:t.label}:{},t.type!==void 0?{type:t.type}:{},t.metadata!==void 0?{metadata:t.metadata}:{}));this.#t.set(e.id,e),this.#s.has(e.id)||this.#s.set(e.id,new Set),this.#n.has(e.id)||this.#n.set(e.id,new Set)}#c(t){this.#t.has(t.from)||this.#a({id:t.from}),this.#t.has(t.to)||this.#a({id:t.to});const e=w(t.from,t.to),s=v(Object.assign({from:t.from,to:t.to,weight:t.weight,actor:t.actor},t.metadata!==void 0?{metadata:t.metadata}:{}));this.#e.set(e,s),this.#s.get(t.from)?.add(t.to),this.#n.get(t.to)?.add(t.from)}#r(t){const e=v(Object.assign({id:t.id,actions:t.actions},t.metadata!==void 0?{metadata:t.metadata}:{}));this.#o.set(e.id,e)}getNode(t){return this.#t.get(t)}getNodes(){return Array.from(this.#t.values())}hasNode(t){return this.#t.has(t)}getTransitions(t){const e=this.#s.get(t);if(!e)return[];const s=[];for(const o of e){const n=w(t,o),i=this.#e.get(n);i&&s.push(i)}return s}getTransitionsTo(t){const e=this.#n.get(t);if(!e)return[];const s=[];for(const o of e){const n=w(o,t),i=this.#e.get(n);i&&s.push(i)}return s}getAllTransitions(){return Array.from(this.#e.values())}hasTransition(t,e){const s=w(t,e);return this.#e.has(s)}getTransition(t,e){const s=w(t,e);return this.#e.get(s)}getProcedure(t){return this.#o.get(t)}getProcedures(){return Array.from(this.#o.values())}hasProcedure(t){return this.#o.has(t)}getStats(){const t={user:0,system:0,automation:0};for(const e of this.#e.values())t[e.actor]++;return v({nodeCount:this.#t.size,transitionCount:this.#e.size,procedureCount:this.#o.size,actorCounts:t})}isStartNode(t){const e=this.#n.get(t);return e===void 0||e.size===0}isEndNode(t){const e=this.#s.get(t);return e===void 0||e.size===0}getStartNodes(){const t=[];for(const[e,s]of this.#n)s.size===0&&t.push(e);return t}getEndNodes(){const t=[];for(const[e,s]of this.#s)s.size===0&&t.push(e);return t}validate(){const t=[];for(const[s,o]of this.#s)if(o.size===0){const n=this.#n.get(s);n&&n.size>0&&t.push({passed:!1,message:`Node '${s}' has no outgoing transitions (dead end)`,severity:"warning",suggestion:"Add outgoing transitions or mark as terminal node",nodeId:s})}this.getStartNodes().length===0&&this.#t.size>0&&t.push({passed:!1,message:"No start nodes found (all nodes have incoming transitions)",severity:"warning",suggestion:"Ensure at least one node has no incoming transitions"});for(const s of this.#t.keys()){const o=this.#n.get(s),n=this.#s.get(s);(!o||o.size===0)&&(!n||n.size===0)&&t.push({passed:!1,message:`Node '${s}' is isolated (no connections)`,severity:"error",suggestion:"Connect this node or remove it",nodeId:s})}for(const s of this.#o.values())for(const o of s.actions)this.#t.has(o)||t.push({passed:!1,message:`Procedure '${s.id}' references unknown node '${o}'`,severity:"error",suggestion:`Add node '${o}' or remove from procedure`});for(const s of this.#i)s(t);return t}isValid(){return this.validate().every(e=>e.severity!=="error")}onValidation(t){return this.#i.add(t),()=>{this.#i.delete(t)}}export(){return v({version:$,exportedAt:m(),nodes:this.getNodes(),transitions:this.getAllTransitions(),procedures:this.getProcedures()})}destroy(){this.#i.clear()}}function M(c){return new K(c)}class Y{#t;#e;#s;#n;#o;#i;#a;#c;#r;constructor(t,e={}){this.#t=t,this.#e=new Map,this.#s=E(),this.#o=e.minWeight??P,this.#c=0,this.#r=m(),this.#n=v(Object.assign({algorithm:e.decayAlgorithm??"ewma",decayFactor:e.decayFactor??D,minWeight:this.#o},e.halfLifeMs!==void 0?{halfLifeMs:e.halfLifeMs}:{})),this.#i=new Set,this.#a=new Set,e.onWeightUpdate&&this.#i.add(e.onWeightUpdate),e.onDecay&&this.#a.add(e.onDecay),e.preloadRecords&&this.preload(e.preloadRecords)}#d(t,e){const s=e-t.lastUpdated;switch(this.#n.algorithm){case"halflife":{const o=this.#n.halfLifeMs??R,n=Math.pow(.5,s/o);return Math.max(t.weight*n,this.#o)}case"ewma":{const o=this.#n.decayFactor??D,n=Math.floor(s/36e5);if(n===0)return t.weight;const i=Math.pow(o,n);return Math.max(t.weight*i,this.#o)}case"linear":{const o=P,n=s/36e5;return Math.max(t.weight-o*n,this.#o)}default:return t.weight}}getWeight(t,e,s){if(!this.#t.hasTransition(t,e))return 0;const o=S(t,e,s),n=this.#e.get(o);return n?this.#d(n,m()):0}getWeights(t,e){const s=this.#t.getTransitions(t),o=m(),n=[];for(const i of s){const a=S(t,i.to,e),l=this.#e.get(a),r=l?this.#d(l,o):0;n.push({to:i.to,weight:i.weight+r,baseWeight:i.weight,predictiveWeight:r})}return n.sort((i,a)=>a.weight-i.weight),n}getModelId(){return this.#s}getDecayConfig(){return this.#n}getStats(){const t=this.#t.getStats();return v({...t,totalWeightUpdates:this.#c,lastUpdateTime:this.#r,modelId:this.#s})}hasWeight(t,e,s){const o=S(t,e,s);return this.#e.has(o)}updateWeight(t,e,s){if(!this.#t.hasTransition(t,e))throw new u("INVALID_TRANSITION",`Cannot update weight for invalid transition: ${t} -> ${e}`,{transitionKey:`${t}::${e}`});const o=S(t,e,s),n=m(),i=this.#e.get(o);let a;i?a=this.#d(i,n)+1:a=1,this.#e.set(o,{weight:a,lastUpdated:n,updateCount:(i?.updateCount??0)+1}),this.#c++,this.#r=n;for(const l of this.#i)l(t,e,s,a)}setWeight(t,e,s,o){if(!this.#t.hasTransition(t,e))throw new u("INVALID_TRANSITION",`Cannot set weight for invalid transition: ${t} -> ${e}`,{transitionKey:`${t}::${e}`});const n=S(t,e,s),i=m(),a=this.#e.get(n);this.#e.set(n,{weight:Math.max(o,this.#o),lastUpdated:i,updateCount:(a?.updateCount??0)+1}),this.#r=i;for(const l of this.#i)l(t,e,s,o)}applyDecay(){const t=m();let e=0;for(const[s,o]of this.#e){const n=this.#d(o,t);n<this.#o?(this.#e.delete(s),e++):n!==o.weight&&(this.#e.set(s,{weight:n,lastUpdated:t,updateCount:o.updateCount}),e++)}for(const s of this.#a)s(e);return e}clear(){this.#e.clear(),this.#c=0}clearActor(t){const e=[];for(const s of this.#e.keys())s.endsWith(`::${t}`)&&e.push(s);for(const s of e)this.#e.delete(s)}preload(t){const e=m();for(const s of t){if(!this.#t.hasTransition(s.from,s.to))continue;const o=S(s.from,s.to,s.actor),n=this.#e.get(o);this.#e.set(o,{weight:(n?.weight??0)+s.count,lastUpdated:e,updateCount:(n?.updateCount??0)+s.count})}}onWeightUpdate(t){return this.#i.add(t),()=>{this.#i.delete(t)}}onDecay(t){return this.#a.add(t),()=>{this.#a.delete(t)}}export(){const t=[];for(const[e,s]of this.#e){const o=e.split("::"),n=o[0],i=o[1],a=o[2];o.length===3&&n&&i&&a&&t.push({from:n,to:i,actor:a,weight:s.weight,lastUpdated:s.lastUpdated,updateCount:s.updateCount})}return v({version:$,exportedAt:m(),modelId:this.#s,weights:t,decayConfig:this.#n})}import(t){if(t.version!==$)throw new u("MODEL_MISMATCH",`Incompatible model version: expected ${$}, got ${t.version}`);this.clear();for(const e of t.weights){const s=S(e.from,e.to,e.actor);this.#e.set(s,{weight:e.weight,lastUpdated:e.lastUpdated,updateCount:e.updateCount})}}destroy(){this.#i.clear(),this.#a.clear(),this.#e.clear()}}function J(c,t){return new Y(c,t)}class X{#t;#e;#s;#n;#o;#i;#a;#c;#r;#d;#h;#l;constructor(t,e,s={}){this.#t=t,this.#e=e,this.#s=new Map,this.#n=new Map,this.#o=s.validateTransitions!==!1,this.#i=s.trackSessions!==!1,this.#a=s.sessionTimeoutMs??_,this.#c=new Set,this.#r=new Set,this.#d=new Set,this.#h=new Set,this.#l=new Set,s.onTransition&&this.#c.add(s.onTransition),s.onPrediction&&this.#r.add(s.onPrediction),s.onSessionStart&&this.#d.add(s.onSessionStart),s.onSessionEnd&&this.#h.add(s.onSessionEnd),s.onError&&this.#l.add(s.onError)}#f(t){for(const e of this.#l)e(t)}#u(t,e,s){const o=this.#s.get(t);if(!o?.active)return;const n=m(),i=o.events[o.events.length-1],a={id:E(),sessionId:t,actor:o.info.actor,from:e,to:s,timestamp:n,duration:i?n-i.timestamp:0,sessionElapsed:n-o.info.startTime,eventType:"transition"};o.events.push(a);const l={...o.info,lastActivity:n,nodeHistory:[...o.info.nodeHistory??[],s]};o.info=l}recordTransition(t,e,s){if(this.#o&&!this.#t.hasTransition(t,e)){const o=new u("INVALID_TRANSITION",`Transition not allowed: ${t} -> ${e}`,{transitionKey:`${t}::${e}`});throw this.#f(o),o}this.#e.updateWeight(t,e,s.actor),this.#i&&s.sessionId&&this.#u(s.sessionId,t,e);for(const o of this.#c)o(t,e,s)}recordTransitions(t){for(const{from:e,to:s,context:o}of t)this.recordTransition(e,s,o)}predictNext(t,e){const s=e.count??W,n=this.#e.getWeights(t,e.actor).slice(0,s).map(i=>i.to);for(const i of this.#r)i(t,n,e);return n}predictNextDetailed(t,e){const s=e.count??W;return{predictions:this.#e.getWeights(t,e.actor).slice(0,s).map(i=>({nodeId:i.to,score:i.weight,baseWeight:i.baseWeight,predictiveWeight:i.predictiveWeight,confidence:i.weight>0?i.predictiveWeight/i.weight:0})),currentNode:t,context:e,computedAt:m()}}isValidTransition(t,e){return this.#t.hasTransition(t,e)}getValidTransitions(t){return this.#t.getTransitions(t)}startSession(t,e){const s=e??E(),o=m(),n=this.#n.get(t);n&&this.#s.get(n)?.active&&this.endSession(n,"abandoned");const i={id:s,actor:t,startTime:o,lastActivity:o,nodeHistory:[]},a={info:i,events:[{id:E(),sessionId:s,actor:t,from:"",to:"",timestamp:o,sessionElapsed:0,eventType:"session_start"}],active:!0};this.#s.set(s,a),this.#n.set(t,s);for(const l of this.#d)l(i);return i}getSession(t){return this.#s.get(t)?.info}getActiveSession(t){const e=this.#n.get(t);if(!e)return;const s=this.#s.get(e);if(!s?.active)return;if(m()-s.info.lastActivity>this.#a){this.endSession(e,"timeout");return}return s.info}hasSession(t){return this.#s.has(t)}endSession(t,e){const s=this.#s.get(t);if(!s)throw new u("SESSION_NOT_FOUND",`Session not found: ${t}`,{sessionId:t});if(!s.active)throw new u("SESSION_ALREADY_ENDED",`Session already ended: ${t}`,{sessionId:t});const o=m();s.events.push({id:E(),sessionId:t,actor:s.info.actor,from:"",to:"",timestamp:o,sessionElapsed:o-s.info.startTime,eventType:"session_end",metadata:{reason:e}}),s.active=!1,this.#n.get(s.info.actor)===t&&this.#n.delete(s.info.actor);for(const n of this.#h)n(s.info,e)}resumeSession(t,e){const s=this.#s.get(t);if(!s)throw new u("SESSION_NOT_FOUND",`Session not found: ${t}`,{sessionId:t});const o=m();s.active=!0,s.info=Object.assign({},s.info,{lastActivity:o},e.path!==void 0?{path:e.path}:{}),this.#n.set(e.actor,t)}getSessionChain(t,e){const s=e?.limit??100,o=[],n=new Set;let i=0;for(const[l,r]of this.#s){if(r.info.actor!==t)continue;if(e?.startTime||e?.endTime){const d=r.info.startTime,f=r.events[r.events.length-1]?.timestamp??d;if(e.startTime&&f<e.startTime||e.endTime&&d>e.endTime)continue}n.add(l);for(const d of r.events)d.eventType==="transition"&&o.push(d);const h=r.events[r.events.length-1];h&&(i+=h.sessionElapsed)}return o.sort((l,r)=>l.timestamp-r.timestamp),{events:o.slice(-s),sessionIds:Array.from(n),totalDuration:i}}truncateChain(t,e){const s=this.#s.get(t);if(!s)throw new u("SESSION_NOT_FOUND",`Session not found: ${t}`,{sessionId:t});const o=e??"recency",n=F;if(!(s.events.length<=n))switch(o){case"recency":s.events.splice(0,s.events.length-n);break;case"frequency":s.events.splice(0,s.events.length-n);break;case"hybrid":s.events.splice(0,s.events.length-n);break}}onTransition(t){return this.#c.add(t),()=>{this.#c.delete(t)}}onPrediction(t){return this.#r.add(t),()=>{this.#r.delete(t)}}onSessionStart(t){return this.#d.add(t),()=>{this.#d.delete(t)}}onSessionEnd(t){return this.#h.add(t),()=>{this.#h.delete(t)}}onError(t){return this.#l.add(t),()=>{this.#l.delete(t)}}getProceduralGraph(){return this.#t}getPredictiveGraph(){return this.#e}destroy(){this.#c.clear(),this.#r.clear(),this.#d.clear(),this.#h.clear(),this.#l.clear(),this.#s.clear(),this.#n.clear()}}function Q(c,t,e){return new X(c,t,e)}class Z{#t;#e;#s;#n;#o;#i;#a;#c;#r;#d;constructor(t={}){this.#t=new Map,this.#e=new Map,this.#s=new Map,this.#n=t.validateOnChange??!1,this.#o=t.allowDuplicateNodes??!1,this.#i=new Set,this.#a=new Set,this.#c=new Set,this.#r=new Set,this.#d=new Set,t.onNodeAdded&&this.#i.add(t.onNodeAdded),t.onNodeRemoved&&this.#a.add(t.onNodeRemoved),t.onTransitionAdded&&this.#c.add(t.onTransitionAdded),t.onTransitionRemoved&&this.#r.add(t.onTransitionRemoved),t.onValidation&&this.#d.add(t.onValidation)}#h(){if(this.#n){const t=this.validate();for(const e of this.#d)e([...t.errors,...t.warnings])}}addNode(t){if(!this.#o&&this.#t.has(t.id))throw new u("DUPLICATE_NODE",`Node already exists: ${t.id}`,{nodeId:t.id});const e=v(Object.assign({id:t.id},t.label!==void 0?{label:t.label}:{},t.type!==void 0?{type:t.type}:{},t.metadata!==void 0?{metadata:t.metadata}:{}));this.#t.set(e.id,e);for(const s of this.#i)s(e);return this.#h(),this}addNodes(t){for(const e of t)this.addNode(e);return this}removeNode(t){if(!this.#t.has(t))throw new u("NODE_NOT_FOUND",`Node not found: ${t}`,{nodeId:t});const e=[];for(const[s,o]of this.#e)(o.from===t||o.to===t)&&e.push(s);for(const s of e){const o=this.#e.get(s);if(this.#e.delete(s),o)for(const n of this.#r)n(o.from,o.to)}this.#t.delete(t);for(const s of this.#a)s(t);return this.#h(),this}updateNode(t,e){const s=this.#t.get(t);if(!s)throw new u("NODE_NOT_FOUND",`Node not found: ${t}`,{nodeId:t});const o=e.label??s.label,n=e.type??s.type,i=e.metadata??s.metadata,a=v(Object.assign({id:s.id},o!==void 0?{label:o}:{},n!==void 0?{type:n}:{},i!==void 0?{metadata:i}:{}));return this.#t.set(t,a),this.#h(),this}addTransition(t){const e=w(t.from,t.to);if(this.#e.has(e))throw new u("DUPLICATE_TRANSITION",`Transition already exists: ${t.from} -> ${t.to}`,{transitionKey:e});this.#t.has(t.from)||this.addNode({id:t.from}),this.#t.has(t.to)||this.addNode({id:t.to});const s=v(Object.assign({from:t.from,to:t.to,weight:t.weight,actor:t.actor},t.metadata!==void 0?{metadata:t.metadata}:{}));this.#e.set(e,s);for(const o of this.#c)o(s);return this.#h(),this}addTransitions(t){for(const e of t)this.addTransition(e);return this}removeTransition(t,e){const s=w(t,e);if(!this.#e.has(s))throw new u("INVALID_TRANSITION",`Transition not found: ${t} -> ${e}`,{transitionKey:s});this.#e.delete(s);for(const o of this.#r)o(t,e);return this.#h(),this}updateTransition(t,e,s){const o=w(t,e),n=this.#e.get(o);if(!n)throw new u("INVALID_TRANSITION",`Transition not found: ${t} -> ${e}`,{transitionKey:o});const i=s.metadata??n.metadata,a=v(Object.assign({from:n.from,to:n.to,weight:s.weight??n.weight,actor:s.actor??n.actor},i!==void 0?{metadata:i}:{}));return this.#e.set(o,a),this.#h(),this}addProcedure(t){if(this.#s.has(t.id))throw new u("INVALID_PROCEDURE",`Procedure already exists: ${t.id}`);const e=v(Object.assign({id:t.id,actions:t.actions},t.metadata!==void 0?{metadata:t.metadata}:{}));return this.#s.set(e.id,e),this.#h(),this}removeProcedure(t){if(!this.#s.has(t))throw new u("INVALID_PROCEDURE",`Procedure not found: ${t}`);return this.#s.delete(t),this.#h(),this}updateProcedure(t,e){const s=this.#s.get(t);if(!s)throw new u("INVALID_PROCEDURE",`Procedure not found: ${t}`);const o=e.metadata??s.metadata,n=v(Object.assign({id:s.id,actions:e.actions??s.actions},o!==void 0?{metadata:o}:{}));return this.#s.set(t,n),this.#h(),this}getNodes(){return Array.from(this.#t.values())}getTransitions(){return Array.from(this.#e.values())}getProcedures(){return Array.from(this.#s.values())}hasNode(t){return this.#t.has(t)}hasTransition(t,e){const s=w(t,e);return this.#e.has(s)}validate(){const t=[],e=[];this.#t.size===0&&t.push({passed:!1,message:"Graph has no nodes",severity:"error",suggestion:"Add at least one node"}),this.#e.size===0&&this.#t.size>1&&t.push({passed:!1,message:"Graph has no transitions",severity:"error",suggestion:"Add transitions to connect nodes"});const s=new Set;for(const o of this.#e.values())s.add(o.from),s.add(o.to);for(const o of this.#t.keys())!s.has(o)&&this.#t.size>1&&e.push({passed:!1,message:`Node '${o}' is isolated`,severity:"warning",suggestion:"Connect this node or remove it",nodeId:o});for(const o of this.#s.values())for(const n of o.actions)this.#t.has(n)||t.push({passed:!1,message:`Procedure '${o.id}' references unknown node '${n}'`,severity:"error",suggestion:`Add node '${n}' or remove from procedure`});return{valid:t.length===0,errors:t,warnings:e}}isValid(){return this.validate().valid}build(){const t=this.validate();if(!t.valid)throw new u("BUILD_FAILED",`Cannot build invalid graph: ${t.errors[0]?.message??"Unknown error"}`);return M({nodes:this.getNodes(),transitions:this.getTransitions(),procedures:this.getProcedures(),validateOnCreate:!1})}clear(){return this.#t.clear(),this.#e.clear(),this.#s.clear(),this}onNodeAdded(t){return this.#i.add(t),()=>{this.#i.delete(t)}}onNodeRemoved(t){return this.#a.add(t),()=>{this.#a.delete(t)}}onTransitionAdded(t){return this.#c.add(t),()=>{this.#c.delete(t)}}onTransitionRemoved(t){return this.#r.add(t),()=>{this.#r.delete(t)}}onValidation(t){return this.#d.add(t),()=>{this.#d.delete(t)}}toJSON(){const t={nodes:this.getNodes(),transitions:this.getTransitions(),procedures:this.getProcedures()};return JSON.stringify(t,null,2)}toYAML(){const t=[];t.push("nodes:");for(const e of this.#t.values())t.push(`  - id: "${e.id}"`),e.label&&t.push(`    label: "${e.label}"`),e.type&&t.push(`    type: "${e.type}"`);t.push(""),t.push("transitions:");for(const e of this.#e.values())t.push(`  - from: "${e.from}"`),t.push(`    to: "${e.to}"`),t.push(`    weight: ${e.weight}`),t.push(`    actor: "${e.actor}"`);if(this.#s.size>0){t.push(""),t.push("procedures:");for(const e of this.#s.values()){t.push(`  - id: "${e.id}"`),t.push("    actions: ");for(const s of e.actions)t.push(`      - "${s}"`)}}return t.join(`
`)}fromJSON(t){let e;try{e=JSON.parse(t)}catch(s){const o=s instanceof Error?{cause:s}:void 0;throw new u("IMPORT_FAILED","Failed to parse JSON",o)}return this.fromDefinition(e)}fromYAML(t){try{const e=[],s=[],o=[];let n=null,i=null,a=[];const l=t.split(`
`);for(const r of l){const h=r.trim();if(!(h===""||h.startsWith("#"))){if(h==="nodes:"){n="nodes";continue}if(h==="transitions:"){n="transitions";continue}if(h==="procedures:"){n="procedures";continue}if(h.startsWith("- ")){i&&n&&(n==="nodes"?this.#l(e,i):n==="transitions"?this.#f(s,i):n==="procedures"&&(this.#u(o,i,a),a=[]));const d=h.slice(2);if(d.includes(":")){const f=d.indexOf(":"),p=d.slice(0,f).trim(),y=d.slice(f+1).trim();i={},i[p]=O(y)}else a.push(O(d))}else if(h.includes(":")&&i){const d=h.indexOf(":"),f=h.slice(0,d).trim(),p=h.slice(d+1).trim();f==="actions"||(i[f]=O(p))}}}return i&&n&&(n==="nodes"?this.#l(e,i):n==="transitions"?this.#f(s,i):n==="procedures"&&this.#u(o,i,a)),this.fromDefinition({nodes:e,transitions:s,procedures:o})}catch(e){if(e instanceof u)throw e;const s=e instanceof Error?{cause:e}:void 0;throw new u("IMPORT_FAILED","Failed to parse YAML",s)}}#l(t,e){const s=e.id;if(typeof s!="string")return;const o=Object.assign({id:s},typeof e.label=="string"?{label:e.label}:{},typeof e.type=="string"?{type:e.type}:{});t.push(o)}#f(t,e){const s=e.from,o=e.to,n=e.weight,i=e.actor;typeof s!="string"||typeof o!="string"||typeof n!="number"||typeof i!="string"||t.push({from:s,to:o,weight:n,actor:i})}#u(t,e,s){const o=e.id;typeof o=="string"&&t.push({id:o,actions:s})}fromDefinition(t){if(this.clear(),t.nodes)for(const e of t.nodes)this.addNode(e);for(const e of t.transitions)this.addTransition(e);if(t.procedures)for(const e of t.procedures)this.addProcedure(e);return this}destroy(){this.#i.clear(),this.#a.clear(),this.#c.clear(),this.#r.clear(),this.#d.clear(),this.clear()}}function tt(c){return new Z(c)}class et{#t;#e;#s;#n;#o;#i;constructor(t,e={}){this.#t=t,this.#e=e.strictMode??!1,this.#s=e.validateGuards??!0,this.#n=e.customRules??[],this.#o=[],this.#i=new Set,e.onValidationComplete&&this.#i.add(e.onValidationComplete)}runStaticChecks(){this.#o.length=0;const t=this.findDanglingNodes();for(const i of t)this.#o.push({passed:!1,message:`Node '${i}' has no outgoing transitions (dead end)`,severity:this.#e?"error":"warning",suggestion:"Add outgoing transitions or mark as terminal node",nodeId:i});const e=this.findUnreachableNodes();for(const i of e)this.#o.push({passed:!1,message:`Node '${i}' is unreachable from any start node`,severity:"error",suggestion:"Add incoming transitions or remove this node",nodeId:i});if(this.findMissingBoundaryNodes().missingStart&&this.#o.push({passed:!1,message:"Graph has no start nodes (all nodes have incoming transitions)",severity:this.#e?"error":"warning",suggestion:"Ensure at least one node has no incoming transitions"}),this.#s){const i=this.validateGuards();for(const a of i)a.valid||this.#o.push({passed:!1,message:`Invalid guard expression: ${a.error}`,severity:"error",suggestion:"Fix the guard syntax",transitionKey:a.transitionKey})}const o=this.validateProcedures();this.#o.push(...o);const n=this.checkConnectivity();n.passed||this.#o.push(n);for(const i of this.#n){const a=i.validate(this.#t);this.#o.push(a)}for(const i of this.#i)i(this.#o);return this.#o}findDanglingNodes(){const t=[],e=this.#t.getNodes();for(const s of e){const o=this.#t.getTransitions(s.id),n=this.#t.getTransitionsTo(s.id);o.length===0&&n.length>0&&t.push(s.id)}return t}findUnreachableNodes(){const t=this.#t.getStartNodes();if(t.length===0)return[];const e=new Set(t),s=[...t];for(;s.length>0;){const i=s.shift();if(!i)continue;const a=this.#t.getTransitions(i);for(const l of a)e.has(l.to)||(e.add(l.to),s.push(l.to))}const o=[],n=this.#t.getNodes();for(const i of n)e.has(i.id)||o.push(i.id);return o}findMissingBoundaryNodes(){const t=this.#t.getStartNodes(),e=this.#t.getEndNodes();return{hasStartNodes:t.length>0,hasEndNodes:e.length>0,startNodes:t,endNodes:e,missingStart:t.length===0&&this.#t.getNodes().length>0,missingEnd:e.length===0&&this.#t.getNodes().length>0}}validateGuards(){const t=[],e=this.#t.getAllTransitions();for(const s of e){const o=s.metadata?.guard;if(!o)continue;const n=w(s.from,s.to);G(o)?t.push({transitionKey:n,guard:o,valid:!0}):t.push({transitionKey:n,guard:o,valid:!1,error:"Invalid guard expression syntax"})}return t}validateProcedures(){const t=[],e=this.#t.getProcedures();for(const s of e){for(const o of s.actions)this.#t.hasNode(o)||t.push({passed:!1,message:`Procedure '${s.id}' references unknown node '${o}'`,severity:"error",suggestion:`Add node '${o}' or remove from procedure`});for(let o=0;o<s.actions.length-1;o++){const n=s.actions[o],i=s.actions[o+1];n&&i&&!this.#t.hasTransition(n,i)&&t.push({passed:!1,message:`Procedure '${s.id}' has disconnected actions: '${n}' -> '${i}'`,severity:"warning",suggestion:`Add transition from '${n}' to '${i}'`})}}return t}checkConnectivity(){const t=this.#t.getNodes();if(t.length===0)return{passed:!0,message:"Empty graph is trivially connected",severity:"info"};const e=new Set,s=new Map;for(const r of t)s.set(r.id,new Set);const o=this.#t.getAllTransitions();for(const r of o)s.get(r.from)?.add(r.to),s.get(r.to)?.add(r.from);const n=t[0];if(!n)return{passed:!0,message:"Empty graph is trivially connected",severity:"info"};const i=n.id,a=[i];for(e.add(i);a.length>0;){const r=a.shift();if(!r)continue;const h=s.get(r)??new Set;for(const d of h)e.has(d)||(e.add(d),a.push(d))}const l=e.size===t.length;return{passed:l,message:l?"Graph is fully connected":`Graph is disconnected:  ${t.length-e.size} node(s) unreachable`,severity:l?"info":"error"}}checkCycles(){const t=[],e=this.#t.getNodes(),s=new Set,o=new Set,n=[],i=a=>{s.add(a),o.add(a),n.push(a);const l=this.#t.getTransitions(a);for(const r of l)if(!s.has(r.to))i(r.to);else if(o.has(r.to)){const h=n.indexOf(r.to),d=[...n.slice(h),r.to];t.push(d)}n.pop(),o.delete(a)};for(const a of e)s.has(a.id)||i(a.id);return t}isValid(){return this.#o.length===0&&this.runStaticChecks(),this.getErrorCount()===0}getErrorCount(){return this.#o.filter(t=>t.severity==="error").length}getWarningCount(){return this.#o.filter(t=>t.severity==="warning").length}getResults(){return this.#o.length===0&&this.runStaticChecks(),this.#o}onValidationComplete(t){return this.#i.add(t),()=>{this.#i.delete(t)}}destroy(){this.#i.clear(),this.#o.length=0}}function st(c,t){return new et(c,t)}class ot{#t;#e;#s;#n;constructor(t,e,s={}){this.#t=t,this.#e=e,this.#s=new Set,this.#n=new Set,s.onAnalysisComplete&&this.#s.add(s.onAnalysisComplete),s.onPatternDetected&&this.#n.add(s.onPatternDetected)}#o(t,e){for(const s of this.#s)s(t,e)}#i(t){for(const e of this.#n)e(t)}findHotLoops(t){const e=t?.threshold??j,s=this.findStronglyConnectedComponents(),o=[];for(const n of s){if(n.nodes.length<2)continue;let i=0,a=0;for(const r of n.nodes){const h=this.#e.getWeights(r,"user");for(const d of h)n.nodes.includes(d.to)&&(i+=d.predictiveWeight,a++)}const l=a>0?i/a:0;l>=e&&o.push({nodes:n.nodes,frequency:l,avgDuration:0,loopType:"hot",exitTransitions:n.exitPoints})}return this.#o("hotLoops",o),o}findInfiniteLoops(t){t?.maxLength;const e=this.findStronglyConnectedComponents(),s=[];for(const o of e)o.exitPoints.length===0&&o.nodes.length>0&&s.push({nodes:o.nodes,frequency:0,avgDuration:0,loopType:"infinite",exitTransitions:[]});return this.#o("infiniteLoops",s),s}findUnproductiveLoops(){const t=this.findStronglyConnectedComponents(),e=[];for(const s of t){if(s.nodes.length<2)continue;let o=0,n=0;for(const i of s.nodes){const a=this.#e.getWeights(i,"user");for(const l of a)s.nodes.includes(l.to)?o+=l.predictiveWeight:n+=l.predictiveWeight}o>n*3&&e.push({nodes:s.nodes,frequency:o,avgDuration:0,loopType:"unproductive",exitTransitions:s.exitPoints})}return this.#o("unproductiveLoops",e),e}findHierarchicalLoops(){const t=this.findStronglyConnectedComponents(),e=[];for(const s of t)for(const o of t){if(s===o||o.nodes.length>=s.nodes.length)continue;o.nodes.every(i=>s.nodes.includes(i))&&e.push({nodes:o.nodes,frequency:0,avgDuration:0,loopType:"hierarchical",exitTransitions:o.exitPoints})}return this.#o("hierarchicalLoops",e),e}findAutomatableLoops(){const t=this.findStronglyConnectedComponents(),e=[];for(const s of t){if(s.nodes.length<2)continue;let o=0,n=0;for(const i of s.nodes){const a=this.#e.getWeights(i,"system"),l=this.#e.getWeights(i,"user");for(const r of a)s.nodes.includes(r.to)&&(o+=r.predictiveWeight);for(const r of l)s.nodes.includes(r.to)&&(n+=r.predictiveWeight)}(o>0||n>10)&&e.push({nodes:s.nodes,frequency:Math.max(o,n),avgDuration:0,loopType:"automatable",exitTransitions:s.exitPoints})}return this.#o("automatableLoops",e),e}findStronglyConnectedComponents(){const t=this.#t.getNodes(),e=[];let s=0;const o=new Map,n=new Map,i=new Set,a=[],l=r=>{o.set(r,s),n.set(r,s),s++,a.push(r),i.add(r);const h=this.#t.getTransitions(r);for(const d of h)o.has(d.to)?i.has(d.to)&&n.set(r,Math.min(n.get(r),o.get(d.to))):(l(d.to),n.set(r,Math.min(n.get(r),n.get(d.to))));if(n.get(r)===o.get(r)){const d=[];let f;do f=a.pop(),f&&(i.delete(f),d.push(f));while(f!==r);if(d.length>0){const p=[],y=[];for(const b of d){const x=this.#t.getTransitionsTo(b),U=this.#t.getTransitions(b);for(const A of x)if(!d.includes(A.from)){p.push(b);break}for(const A of U)d.includes(A.to)||y.push(A.to)}e.push({id:`scc-${e.length}`,nodes:d,entryPoints:[...new Set(p)],exitPoints:[...new Set(y)]})}}};for(const r of t)o.has(r.id)||l(r.id);return e}findSCCKosaraju(){const t=this.#t.getNodes(),e=new Set,s=[],o=r=>{e.add(r);const h=this.#t.getTransitions(r);for(const d of h)e.has(d.to)||o(d.to);s.push(r)};for(const r of t)e.has(r.id)||o(r.id);const n=new Map;for(const r of t)n.set(r.id,[]);const i=this.#t.getAllTransitions();for(const r of i)n.get(r.to)?.push(r.from);e.clear();const a=[],l=(r,h)=>{e.add(r),h.push(r);const d=n.get(r)??[];for(const f of d)e.has(f)||l(f,h)};for(;s.length>0;){const r=s.pop();if(!e.has(r)){const h=[];l(r,h),h.length>0&&a.push({id:`scc-${a.length}`,nodes:h,entryPoints:[],exitPoints:[]})}}return a}classifyEdges(){const t=this.#t.getNodes(),e=[],s=new Map,o=new Map;let n=0;const i=(a,l)=>{s.set(a,n++);const r=this.#t.getTransitions(a);for(const h of r){let d;s.has(h.to)?o.has(h.to)?s.get(a)<s.get(h.to)?(d="forward",e.push({from:h.from,to:h.to,classification:d})):(d="cross",e.push({from:h.from,to:h.to,classification:d})):(d="back",e.push({from:h.from,to:h.to,classification:d})):(d="tree",e.push({from:h.from,to:h.to,classification:d}),i(h.to))}o.set(a,n++)};for(const a of t)s.has(a.id)||i(a.id);return e}findBottlenecks(t){const e=t?.trafficThreshold??q;t?.delayThreshold;const s=[],o=this.#t.getNodes();for(const n of o){const i=this.#t.getTransitionsTo(n.id),a=this.#t.getTransitions(n.id);let l=0,r=0;for(const d of i){const p=this.#e.getWeights(d.from,"user").find(y=>y.to===n.id);p&&(l+=p.predictiveWeight)}for(const d of a){const p=this.#e.getWeights(n.id,"user").find(y=>y.to===d.to);p&&(r+=p.predictiveWeight)}const h=r>0?l/r:l;l>=e&&h>2&&s.push({nodeId:n.id,incomingTraffic:l,outgoingTraffic:r,avgDelay:0,maxDelay:0,congestionScore:h})}return this.#o("bottlenecks",s),s}findAutomationOpportunities(t){const e=t?.minRepetitions??z,s=t?.minSequenceLength??V,o=t?.maxSequenceLength??H,n=[],i=this.findStronglyConnectedComponents();for(const a of i){if(a.nodes.length<s||a.nodes.length>o)continue;let l=0;for(const h of a.nodes){const d=this.#e.getWeights(h,"user");for(const f of d)l+=f.predictiveWeight}const r=l/a.nodes.length;if(r>=e){let h="robotic";r>20?h="scheduled":r>10&&(h="triggered");const d=Math.min(r/20,1);n.push({sequence:a.nodes,frequency:r,avgDuration:0,automationType:h,suggestion:`Automate sequence:  ${a.nodes.join(" -> ")}`,confidence:d}),this.#i({sequence:a.nodes,frequency:r,avgDuration:0,actors:["user"]})}}return this.#o("automationOpportunities",n),n}analyzeByContext(t){const e=[];for(const s of t.groupBy)if(s==="procedure"){const o=this.#t.getProcedures();for(const n of o){const i=[];let a=0;for(let l=0;l<n.actions.length-1;l++){const r=n.actions[l],h=n.actions[l+1];if(r&&h){const f=this.#e.getWeights(r,"user").find(p=>p.to===h);f&&(a+=f.predictiveWeight)}}i.push({sequence:n.actions,frequency:a,avgDuration:0,actors:["user"]}),e.push({groupKey:"procedure",groupValue:n.id,patterns:i,recommendations:a>10?["High usage - consider optimization"]:[]})}}return this.#o("contextAnalysis",e),e}compareContexts(t,e){return[]}getSummary(){const t=this.findHotLoops(),e=this.findBottlenecks(),s=this.findAutomationOpportunities(),o=this.findStronglyConnectedComponents(),n=this.#t.getNodes();let i=0,a=0;for(const h of n){const d=this.#t.getTransitions(h.id);i+=d.length,a++}const l=a>0?i/a:0,r=[];for(const h of o.slice(0,5)){let d=0;for(const f of h.nodes){const p=this.#e.getWeights(f,"user");for(const y of p)d+=y.predictiveWeight}r.push({sequence:h.nodes,frequency:d/h.nodes.length,avgDuration:0,actors:["user"]})}return r.sort((h,d)=>d.frequency-h.frequency),{loopCount:t.length,bottleneckCount:e.length,automationOpportunityCount:s.length,sccCount:o.length,avgPathLength:l,mostFrequentPaths:r.slice(0,5)}}onAnalysisComplete(t){return this.#s.add(t),()=>{this.#s.delete(t)}}onPatternDetected(t){return this.#n.add(t),()=>{this.#n.delete(t)}}destroy(){this.#s.clear(),this.#n.clear()}}function nt(c,t,e){return new ot(c,t,e)}const it=[{from:"login",to:"dashboard",weight:1,actor:"user"},{from:"dashboard",to:"settings",weight:1,actor:"user"},{from:"dashboard",to:"profile",weight:1,actor:"user"},{from:"dashboard",to:"checkout",weight:1,actor:"user"},{from:"settings",to:"dashboard",weight:1,actor:"user"},{from:"profile",to:"dashboard",weight:1,actor:"user"},{from:"checkout",to:"payment",weight:1,actor:"user"},{from:"checkout",to:"dashboard",weight:1,actor:"user"},{from:"payment",to:"confirmation",weight:1,actor:"user"},{from:"confirmation",to:"dashboard",weight:1,actor:"user"}],g={currentNode:"login",sessionId:"",transitionHistory:[],predictions:[]},T=M({transitions:it,validateOnCreate:!0}),C=J(T,{decayAlgorithm:"ewma",decayFactor:.9}),N=Q(T,C,{validateTransitions:!0,trackSessions:!0}),rt=st(T),L=nt(T,C),k=N.startSession("user");g.sessionId=k.id;function I(){const c=document.getElementById("app");if(!c)return;g.predictions=[...N.predictNext(g.currentNode,{actor:"user",sessionId:g.sessionId,path:`/${g.currentNode}`,count:5})];const t=N.getValidTransitions(g.currentNode),e=T.getStats(),s=L.getSummary();c.innerHTML=`
		<div class="container">
			<header>
				<h1>üîÑ ActionLoop Showcase</h1>
				<p class="subtitle">Predictive Procedural Action Loop System</p>
			</header>

			<div class="grid">
				<section class="card current-state">
					<h2>üìç Current State</h2>
					<div class="state-display">
						<span class="node-badge current">${g.currentNode}</span>
					</div>
					<div class="session-info">
						<small>Session: ${g.sessionId.slice(0,8)}...</small>
					</div>
				</section>

				<section class="card predictions">
					<h2>üîÆ Predictions</h2>
					<p class="description">Ranked next actions based on learned patterns:</p>
					<div class="prediction-list">
						${g.predictions.length>0?g.predictions.map((o,n)=>`
								<button class="prediction-btn" data-target="${o}">
									<span class="rank">${n+1}</span>
									<span class="name">${o}</span>
								</button>
							`).join(""):'<p class="empty">No predictions (end node)</p>'}
					</div>
				</section>

				<section class="card valid-actions">
					<h2>‚úÖ Valid Actions</h2>
					<p class="description">All allowed transitions from current node:</p>
					<div class="action-list">
						${t.map(o=>`
							<button class="action-btn" data-target="${o.to}">
								${o.to}
							</button>
						`).join("")}
					</div>
				</section>

				<section class="card history">
					<h2>üìú Transition History</h2>
					<div class="history-list">
						${g.transitionHistory.length>0?g.transitionHistory.slice(-5).reverse().map(o=>`
								<div class="history-item">
									<span class="from">${o.from}</span>
									<span class="arrow">‚Üí</span>
									<span class="to">${o.to}</span>
									<span class="time">${o.time.toLocaleTimeString()}</span>
								</div>
							`).join(""):'<p class="empty">No transitions recorded</p>'}
					</div>
				</section>

				<section class="card graph-viz">
					<h2>üìä Workflow Graph</h2>
					<div class="graph-display">
						${at()}
					</div>
				</section>

				<section class="card stats">
					<h2>üìà Statistics</h2>
					<div class="stats-grid">
						<div class="stat">
							<span class="value">${e.nodeCount}</span>
							<span class="label">Nodes</span>
						</div>
						<div class="stat">
							<span class="value">${e.transitionCount}</span>
							<span class="label">Transitions</span>
						</div>
						<div class="stat">
							<span class="value">${s.loopCount}</span>
							<span class="label">Loops</span>
						</div>
						<div class="stat">
							<span class="value">${s.sccCount}</span>
							<span class="label">SCCs</span>
						</div>
					</div>
				</section>
			</div>

			<section class="card tools">
				<h2>üõ†Ô∏è Tools</h2>
				<div class="tool-buttons">
					<button id="btn-validate">Validate Graph</button>
					<button id="btn-analyze">Analyze Patterns</button>
					<button id="btn-export">Export Weights</button>
					<button id="btn-reset">Reset Session</button>
				</div>
				<div id="tool-output" class="tool-output"></div>
			</section>

			<footer>
				<p>@mikesaintsg/actionloop ‚Äî Zero dependency workflow prediction</p>
			</footer>
		</div>
	`,ct()}function at(){const c=T.getNodes(),t=T.getAllTransitions();return`
		<div class="graph-nodes">
			${c.map(e=>`
				<span class="graph-node ${e.id===g.currentNode?"active":""}">
					${e.id}
				</span>
			`).join("")}
		</div>
		<div class="graph-edges">
			${t.slice(0,6).map(e=>`
				<span class="graph-edge">${e.from} ‚Üí ${e.to}</span>
			`).join("")}
			${t.length>6?`<span class="graph-edge">+${t.length-6} more</span>`:""}
		</div>
	`}function ct(){document.querySelectorAll("[data-target]").forEach(c=>{c.addEventListener("click",t=>{const e=t.currentTarget.dataset.target;e&&dt(e)})}),document.getElementById("btn-validate")?.addEventListener("click",()=>{const c=rt.runStaticChecks(),t=document.getElementById("tool-output");t&&(c.length===0?t.innerHTML='<div class="success">‚úÖ Graph is valid! No issues found.</div>':t.innerHTML=c.map(e=>`<div class="${e.severity}">‚ö†Ô∏è [${e.severity}] ${e.message}</div>`).join(""))}),document.getElementById("btn-analyze")?.addEventListener("click",()=>{const c=L.findHotLoops(),t=L.findBottlenecks(),e=L.findAutomationOpportunities(),s=document.getElementById("tool-output");s&&(s.innerHTML=`
				<div class="info">üîç Analysis Results:</div>
				<div class="info">‚Ä¢ Hot loops: ${c.length}</div>
				<div class="info">‚Ä¢ Bottlenecks: ${t.length}</div>
				<div class="info">‚Ä¢ Automation opportunities: ${e.length}</div>
			`)}),document.getElementById("btn-export")?.addEventListener("click",()=>{const c=C.export(),t=document.getElementById("tool-output");t&&(t.innerHTML=`
				<div class="info">üì¶ Exported ${c.weights.length} weights</div>
				<pre>${JSON.stringify(c,null,2).slice(0,500)}...</pre>
			`)}),document.getElementById("btn-reset")?.addEventListener("click",()=>{N.endSession(g.sessionId,"abandoned");const c=N.startSession("user");g.sessionId=c.id,g.currentNode="login",g.transitionHistory=[],C.clear(),I();const t=document.getElementById("tool-output");t&&(t.innerHTML='<div class="success">üîÑ Session reset. Starting fresh.</div>')})}function dt(c){const t=g.currentNode;try{N.recordTransition(t,c,{actor:"user",sessionId:g.sessionId,path:`/${c}`}),g.transitionHistory.push({from:t,to:c,time:new Date}),g.currentNode=c,I()}catch{const s=document.getElementById("tool-output");s&&(s.innerHTML=`<div class="error">‚ùå Invalid transition: ${t} ‚Üí ${c}</div>`)}}function ht(){const c=tt();c.addNode({id:"start",label:"Start"}).addNode({id:"middle",label:"Middle"}).addNode({id:"end",label:"End"}).addTransition({from:"start",to:"middle",weight:1,actor:"user"}).addTransition({from:"middle",to:"end",weight:1,actor:"user"});const t=c.toJSON();console.log("Builder JSON output:",t);const e=c.validate();console.log("Builder validation:",e),c.destroy()}document.addEventListener("DOMContentLoaded",()=>{I(),ht(),console.log("ActionLoop Showcase initialized"),console.log("Procedural graph:",T.getStats()),console.log("Engine session:",k.id)});</script>
  <style rel="stylesheet" crossorigin>:root{--color-bg: #0d1117;--color-surface: #161b22;--color-border: #30363d;--color-text: #c9d1d9;--color-text-muted: #8b949e;--color-primary: #58a6ff;--color-success: #3fb950;--color-warning: #d29922;--color-error: #f85149;--color-accent: #a371f7;--radius: 8px;--shadow: 0 8px 24px rgba(0, 0, 0, .3)}*{box-sizing:border-box;margin:0;padding:0}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,sans-serif;background:var(--color-bg);color:var(--color-text);line-height:1.6;min-height:100vh}.container{max-width:1200px;margin:0 auto;padding:2rem}header{text-align:center;margin-bottom:2rem}header h1{font-size:2.5rem;margin-bottom:.5rem;background:linear-gradient(135deg,var(--color-primary),var(--color-accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.subtitle{color:var(--color-text-muted);font-size:1.1rem}.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1.5rem;margin-bottom:2rem}.card{background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius);padding:1.5rem;box-shadow:var(--shadow)}.card h2{font-size:1.25rem;margin-bottom:1rem;color:var(--color-text);display:flex;align-items:center;gap:.5rem}.card .description{color:var(--color-text-muted);font-size:.875rem;margin-bottom:1rem}.current-state .state-display{display:flex;justify-content:center;margin:1.5rem 0}.node-badge{background:var(--color-border);padding:.5rem 1.5rem;border-radius:var(--radius);font-size:1.5rem;font-weight:600}.node-badge.current{background:linear-gradient(135deg,var(--color-primary),var(--color-accent));color:#fff}.session-info{text-align:center;color:var(--color-text-muted)}.prediction-list{display:flex;flex-direction:column;gap:.5rem}.prediction-btn{display:flex;align-items:center;gap:1rem;padding:.75rem 1rem;background:var(--color-bg);border:1px solid var(--color-border);border-radius:var(--radius);color:var(--color-text);cursor:pointer;transition:all .2s ease}.prediction-btn:hover{border-color:var(--color-primary);background:#58a6ff1a}.prediction-btn .rank{background:var(--color-primary);color:#fff;width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:600}.prediction-btn .name{font-weight:500}.action-list{display:flex;flex-wrap:wrap;gap:.5rem}.action-btn{padding:.5rem 1rem;background:var(--color-bg);border:1px solid var(--color-border);border-radius:var(--radius);color:var(--color-text);cursor:pointer;transition:all .2s ease}.action-btn:hover{border-color:var(--color-success);background:#3fb9501a}.history-list{display:flex;flex-direction:column;gap:.5rem}.history-item{display:flex;align-items:center;gap:.5rem;padding:.5rem;background:var(--color-bg);border-radius:var(--radius);font-size:.875rem}.history-item .from,.history-item .to{font-weight:500}.history-item .arrow{color:var(--color-text-muted)}.history-item .time{margin-left:auto;color:var(--color-text-muted);font-size:.75rem}.graph-display{padding:1rem;background:var(--color-bg);border-radius:var(--radius)}.graph-nodes{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:1rem}.graph-node{padding:.25rem .75rem;background:var(--color-border);border-radius:var(--radius);font-size:.875rem}.graph-node.active{background:var(--color-primary);color:#fff}.graph-edges{display:flex;flex-wrap:wrap;gap:.5rem}.graph-edge{padding:.25rem .5rem;background:transparent;border:1px dashed var(--color-border);border-radius:var(--radius);font-size:.75rem;color:var(--color-text-muted)}.stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1rem}.stat{text-align:center;padding:1rem;background:var(--color-bg);border-radius:var(--radius)}.stat .value{display:block;font-size:2rem;font-weight:600;color:var(--color-primary)}.stat .label{font-size:.75rem;color:var(--color-text-muted);text-transform:uppercase;letter-spacing:.05em}.tools{grid-column:1 / -1}.tool-buttons{display:flex;flex-wrap:wrap;gap:.75rem;margin-bottom:1rem}.tool-buttons button{padding:.5rem 1rem;background:var(--color-primary);border:none;border-radius:var(--radius);color:#fff;font-weight:500;cursor:pointer;transition:all .2s ease}.tool-buttons button:hover{opacity:.9;transform:translateY(-1px)}.tool-output{background:var(--color-bg);border-radius:var(--radius);padding:1rem;min-height:60px;font-family:SF Mono,Monaco,Courier New,monospace;font-size:.875rem}.tool-output .success{color:var(--color-success)}.tool-output .error{color:var(--color-error)}.tool-output .warning{color:var(--color-warning)}.tool-output .info{color:var(--color-text-muted);margin-bottom:.25rem}.tool-output pre{margin-top:.5rem;padding:.5rem;background:var(--color-surface);border-radius:var(--radius);overflow-x:auto;font-size:.75rem}footer{text-align:center;padding:2rem;color:var(--color-text-muted);font-size:.875rem;border-top:1px solid var(--color-border)}.empty{color:var(--color-text-muted);font-style:italic;text-align:center;padding:1rem}@media(max-width:768px){.container{padding:1rem}header h1{font-size:1.75rem}.grid{grid-template-columns:1fr}.stats-grid{grid-template-columns:repeat(4,1fr)}.stat .value{font-size:1.5rem}}</style>
</head>
<body>
<div id="app"></div>
</body>
</html>
